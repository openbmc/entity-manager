{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4fcae491_6363c209",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 12,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-12-02T23:09:52Z",
      "side": 1,
      "message": "I\u0027m a little confused here.  Won\u0027t unit tests not rely on the timer at all?  They can just directly call the \"timer is done\" method.",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 12,
        "endChar": 40
      },
      "revId": "680231eb3a3621df04faf2056fb036463212c4ad",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f7b8424_f7b86493",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 12,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2025-12-03T11:32:30Z",
      "side": 1,
      "message": "Why are we limited to unit tests? Don\u0027t we want to write integration tests as well?\n\n\u003e They can just directly call the \"timer is done\" method.\n\nWhy would we deviate from the control flow we are testing, unless necessary ?",
      "parentUuid": "4fcae491_6363c209",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 12,
        "endChar": 40
      },
      "revId": "680231eb3a3621df04faf2056fb036463212c4ad",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a06347d0_78332a54",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 12,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2026-01-06T17:10:21Z",
      "side": 1,
      "message": "I\u0027m still not clear why we should deviate from the control flow we are looking to test, when the alternative is a simple change like here.\n\nCan you push a change with your version of an integration test (for EM probing a config on DBus interfaces) so i can understand how that would look like?",
      "parentUuid": "6f7b8424_f7b86493",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 12,
        "endChar": 40
      },
      "revId": "680231eb3a3621df04faf2056fb036463212c4ad",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6c622c0_cc5fc6cb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 12,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2026-01-08T19:09:45Z",
      "side": 1,
      "message": "\u003e Don\u0027t we want to write integration tests as well?\n\nPeoples definition of unit/integration tests differ here, so lets just keep this targetted to the code itself.  Do you have an example of the test you\u0027re trying to run?\n\n\n\u003e your version of an integration test\n\nSure, I can look at this.  As a goal, we shouldn\u0027t ever be calling sleep or a timer in a unit test.  Integration tests should run the full application ideally.  Maybe you\u0027re talking about something in the middle?",
      "parentUuid": "a06347d0_78332a54",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 12,
        "endChar": 40
      },
      "revId": "680231eb3a3621df04faf2056fb036463212c4ad",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67bcab4c_09d1797c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 12,
      "author": {
        "id": 1001712
      },
      "writtenOn": "2026-01-09T07:39:02Z",
      "side": 1,
      "message": "\u003e Do you have an example of the test you\u0027re trying to run?\n\n- https://gerrit.openbmc.org/c/openbmc/entity-manager/+/85478 and\n- https://gerrit.openbmc.org/c/openbmc/entity-manager/+/85557\n\n\u003e As a goal, we shouldn\u0027t ever be calling sleep or a timer in a unit test.  \n\nTo avoid race conditions? I would rather debug race conditions appearing in a testcase, than on a BMC. Wondering why you consider it an antipattern.\n\n\u003e Integration tests should run the full application ideally\n\nI don\u0027t see that in the near future, there is the filesystem dependency, mapper dependency, large timeouts, loading 200+ json files, reserving a unique bus name (test cannot run in parallel), ...\n\n\u003e Maybe you\u0027re talking about something in the middle?\n\nPrecisely. I do not see the value in waiting for some timeouts to complete.\nIf i remember right, in our CI the tests are run multiple times.\n\nSo any timeouts would just accumulate and delay results for everyone, i would suggest to avoid running the full application in a testcase.",
      "parentUuid": "f6c622c0_cc5fc6cb",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 12,
        "endChar": 40
      },
      "revId": "680231eb3a3621df04faf2056fb036463212c4ad",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}