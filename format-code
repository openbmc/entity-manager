#!/bin/bash

set -e

# When called from openbmc-build-scripts, the `pwd` could be anywhere, but
# the root of the repo is passed in the first argument.  Switch to the repo
# root so npm/git run in the right place.
if [ -n "$1" ]; then
    cd "$1"
fi
python3 scripts/autojson.py configurations
clang-format-13 -i -style=file $(bash -c "comm -23 <(git ls-files | grep -E '[.][chi](pp)?$' | sort) <(sort .clang-ignore)")
